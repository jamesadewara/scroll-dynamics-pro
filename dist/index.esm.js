import{jsx as t}from"react/jsx-runtime";import{useRef as e,useEffect as r,useContext as n,createContext as i,useLayoutEffect as o,useState as c}from"react";var a=i(null),s=function(n){var i=n.children,o=n.containerRef,c=e(new Set),s=e(0),l=e(!1),u=e(0);r(function(){var t=(null==o?void 0:o.current)||("undefined"!=typeof window?window:null);if(t){var e=function(){return t instanceof Window?t.scrollY:t.scrollTop},r=e();s.current=r,u.current=r;var n=function(){var t=e(),r=t-u.current;s.current=t,u.current=t,c.current.forEach(function(t){return t(s.current,r)}),l.current=!1},i=function(){l.current||(requestAnimationFrame(n),l.current=!0)};return t.addEventListener("scroll",i,{passive:!0}),t instanceof Window&&t.addEventListener("resize",i,{passive:!0}),function(){t.removeEventListener("scroll",i),t instanceof Window&&t.removeEventListener("resize",i)}}},[o]);return t(a.Provider,{value:{subscribe:function(t){return c.current.add(t),t(s.current,0),function(){c.current.delete(t)}},getScrollY:function(){return s.current}},children:i})},l=function(){var t=n(a);if(!t)throw new Error("useScroll must be used within a ScrollProvider");return t},u=function(){return u=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},u.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var f={clamp:function(t,e,r){return Math.min(r,Math.max(e,t))},mapRange:function(t,e,r,n,i){return n+(t-e)/(r-e)*(i-n)},lerp:function(t,e,r){return t*(1-r)+e*r},abs:function(t){return Math.abs(t)},min:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Math.min.apply(Math,t)},max:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Math.max.apply(Math,t)},floor:function(t){return Math.floor(t)},cos:function(t){return Math.cos(t)},sin:function(t){return Math.sin(t)},PI:Math.PI},d=function(n){var i=n.direction,c=void 0===i?"vertical":i,a=n.children,s=n.className,d=n.style,h=n.trackLength,v=void 0===h?"300vw":h,p=l().subscribe,w=e(null),g=e(null),m=e(!1);r(function(){var t=new IntersectionObserver(function(t){var e=t[0];m.current=e.isIntersecting},{threshold:0});return w.current&&t.observe(w.current),function(){return t.disconnect()}},[]);var y=e({offsetTop:0,trackHeight:0,windowHeight:0,scrollWidth:0,windowWidth:0});return r(function(){if("horizontal"===c){var t=function(){if(w.current&&g.current){var t=w.current.getBoundingClientRect(),e=window.scrollY||window.pageYOffset;y.current={offsetTop:t.top+e,trackHeight:t.height,windowHeight:window.innerHeight,scrollWidth:g.current.scrollWidth,windowWidth:window.innerWidth}}};return t(),window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}},[c,a]),r(function(){if("horizontal"===c)return p(function(t){if(m.current&&w.current&&g.current){var e=y.current,r=e.offsetTop,n=e.trackHeight,i=e.windowHeight,o=e.scrollWidth,c=e.windowWidth,a=n-i;if(!(a<=0)){var s=f.clamp(-(r-t)/a,0,1),l=o-c;if(l>0){var u=s*l;g.current.style.transform="translateX(-".concat(u,"px)")}}}})},[c,p]),o(function(){if("horizontal"===c&&w.current&&g.current){var t=w.current.getBoundingClientRect(),e=-t.top/(t.height-window.innerHeight),r=f.clamp(e,0,1),n=g.current,i=n.scrollWidth-window.innerWidth;i>0&&(n.style.transform="translateX(-".concat(r*i,"px)"))}},[c]),t("div","vertical"===c?{className:s,style:d,children:a}:{ref:w,className:s,style:u({position:"relative",height:v},d),children:t("div",{style:{position:"sticky",top:0,height:"100vh",width:"100%",overflow:"hidden"},children:t("div",{ref:g,style:{height:"100%",display:"flex",willChange:"transform"},children:a})})})},h=function(n){var i=n.children,o=n.effect,c=void 0===o?"parallax":o,a=n.speed,s=void 0===a?.2:a,d=n.intensity,h=void 0===d?1:d,v=n.direction,p=void 0===v?"up":v,w=n.range,g=void 0===w?[0,1]:w,m=n.transform,y=n.onEnter,b=n.onLeave,x=n.className,Y=n.style,H=l().subscribe,W=e(null),E=e(!1),M=e(0);return r(function(){var t=new IntersectionObserver(function(t){var e=t[0],r=E.current;if(E.current=e.isIntersecting,e.isIntersecting){if(!r&&y&&y(),W.current){var n=W.current.getBoundingClientRect();M.current=n.top+window.scrollY}}else r&&b&&b()},{threshold:0});return W.current&&t.observe(W.current),function(){return t.disconnect()}},[]),r(function(){return H(function(t,e){if(E.current&&W.current){var r=W.current,n=r.getBoundingClientRect(),i=window.innerHeight,o=i+n.height,a=(i-n.top)/o,l=g[0],u=g[1],d=0;if(d=l===u?a>=l?1:0:f.clamp((a-l)/(u-l),0,1),"parallax"===c){var v=(n.top-i/2)*s;r.style.transform="translateY(".concat(v,"px)")}else if("fade"===c)r.style.opacity=d.toString(),h>0&&(r.style.transform="translateY(".concat(20*(1-d)*h,"px)"));else if("scale"===c){var w=.8+.2*f.clamp(d,0,1)*h;r.style.transform="scale(".concat(w,")")}else if("skew-velocity"===c){var y=15*h,b=f.max(-y,f.min(y,.1*e)),x=1+f.min(.2,f.abs(5e-4*e)*h);r.style.transform="skewY(".concat(b,"deg) scaleY(").concat(x,")")}else if("rotate"===c){var Y=2*(d-.5)*(45*h);r.style.transform="rotate(".concat(Y,"deg)")}else if("rotate-x"===c){Y=2*(.5-d)*(45*h);r.style.transform="perspective(1000px) rotateX(".concat(Y,"deg)")}else if("rotate-y"===c){Y=2*(d-.5)*(45*h);r.style.transform="perspective(1000px) rotateY(".concat(Y,"deg)")}else if("slide-in"===c)if(d>=1)r.style.transform="none",r.style.opacity="1";else{var H=(1-d)*(100*h);r.style.opacity=d.toString(),"up"===p?r.style.transform="translateY(".concat(H,"px)"):"down"===p?r.style.transform="translateY(".concat(-H,"px)"):"left"===p?r.style.transform="translateX(".concat(H,"px)"):"right"===p&&(r.style.transform="translateX(".concat(-H,"px)"))}else if("blur"===c){var M=10*(1-d)*h;r.style.filter="blur(".concat(M,"px)"),r.style.opacity=d.toString()}else if("hue-rotate"===c){Y=360*d*h;r.style.filter="hue-rotate(".concat(Y,"deg)")}else"custom"===c&&m&&m(r,d,t,e)}})},[c,s,h,p,g,m,H]),t("div",{ref:W,className:x,style:u({willChange:"transform, opacity"},Y),children:i})},v=function(t){var e=c(0),n=e[0],i=e[1],o=l().subscribe;return r(function(){var e=t.current;if(e){var r=!1,n={top:0,height:0,windowHeight:0},c=new IntersectionObserver(function(t){var i=t[0];if(r=i.isIntersecting){var o=e.getBoundingClientRect(),c=window.scrollY||window.pageYOffset;n={top:o.top+c,height:o.height,windowHeight:window.innerHeight}}},{threshold:0});c.observe(e);var a=o(function(t){if(r){var e=n.top,o=n.height-n.windowHeight;if(!(o<=0)){var c=(t-e)/o;c=f.clamp(c,0,1),i(c)}}});return function(){c.disconnect(),a()}}},[t,o]),n},p=function(r){var n=r.height,i=void 0===n?"300vh":n,o=r.children,c=r.className,a=r.style,s=e(null),l=v(s);return t("div",{ref:s,className:c,style:u({height:i,position:"relative"},a),children:t("div",{style:{position:"sticky",top:0,height:"100vh",width:"100%",overflow:"hidden"},children:o(l)})})};export{s as ScrollProvider,d as ScrollSection,h as ScrollTransform,f as ScrollUtils,p as Scrollytelling,l as useScroll,v as useScrollProgress};
//# sourceMappingURL=index.esm.js.map
